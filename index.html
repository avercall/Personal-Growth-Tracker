<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Personal Growth Tracker - Test Mode</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; background: #f9fafb; color: #333; }
    h1,h2 { color:#222; }
    section { background:#fff; padding:20px; margin-bottom:20px; border-radius:12px; box-shadow:0 2px 6px rgba(0,0,0,0.1); }
    button { margin:5px; padding:10px 15px; border:none; border-radius:8px; background:#2563eb; color:white; cursor:pointer; transition:0.2s; }
    button:hover { background:#1d4ed8; }
    textarea,input { width:100%; padding:8px; margin:8px 0; border-radius:6px; border:1px solid #ccc; }
    ul { list-style:none; padding:0; }
    li { background:#f3f4f6; margin:5px 0; padding:10px; border-radius:6px; }
    .timer { font-size:1.5rem; font-weight:bold; margin:10px 0; }
  </style>
</head>
<body>
  <h1>üå± Personal Growth Tracker - Test Mode</h1>

  <section>
    <h2>‚è± Job Hours</h2>
    <p id="timer" class="timer">00:00:00</p>
    <button id="startBtn">Start</button>
    <button id="stopBtn">Stop</button>
    <button id="logBtn">Log</button>
    <ul id="logList"></ul>
  </section>

  <section>
    <h2>‚ú® Magic Questions</h2>
    <button id="generateBtn">Generate ‚ú®</button>
    <p id="question"></p>
  </section>

  <section>
    <h2>üìì Daily Reflection</h2>
    <textarea id="reflection" placeholder="Write your reflection..."></textarea>
    <button id="saveReflection">Save Reflection</button>
    <ul id="reflectionList"></ul>
  </section>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.0.0/firebase-app.js";
    import { getFirestore, collection, addDoc, getDocs } from "https://www.gstatic.com/firebasejs/9.0.0/firebase-firestore.js";

    // --- Firebase Config ---
    const firebaseConfig = {
      apiKey: "YOUR_API_KEY",
      authDomain: "YOUR_PROJECT.firebaseapp.com",
      projectId: "YOUR_PROJECT_ID",
      storageBucket: "YOUR_PROJECT.appspot.com",
      messagingSenderId: "YOUR_SENDER_ID",
      appId: "YOUR_APP_ID"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    // --- Timer ---
    let timerInterval;
    let startTime;
    const timerDisplay = document.getElementById("timer");
    const logList = document.getElementById("logList");

    document.getElementById("startBtn").onclick = () => {
      startTime = Date.now();
      timerInterval = setInterval(updateTimer, 1000);
    };

    document.getElementById("stopBtn").onclick = () => clearInterval(timerInterval);

    document.getElementById("logBtn").onclick = async () => {
      clearInterval(timerInterval);
      const duration = timerDisplay.textContent;
      const entry = `Worked for ${duration}`;
      addLogToPage(entry);

      await addDoc(collection(db, "logs"), {
        entry,
        date: new Date()
      });
    };

    function updateTimer() {
      const elapsed = Date.now() - startTime;
      const hrs = String(Math.floor(elapsed / 3600000)).padStart(2, "0");
      const mins = String(Math.floor((elapsed % 3600000) / 60000)).padStart(2, "0");
      const secs = String(Math.floor((elapsed % 60000) / 1000)).padStart(2, "0");
      timerDisplay.textContent = `${hrs}:${mins}:${secs}`;
    }

    function addLogToPage(text) {
      const li = document.createElement("li");
      li.textContent = text;
      logList.appendChild(li);
    }

    // --- Magic Questions ---
    const questions = [
      "What did I learn today?",
      "How can I improve tomorrow?",
      "What am I grateful for?",
      "What challenged me today?",
      "What am I proud of?"
    ];
    document.getElementById("generateBtn").onclick = () => {
      const q = questions[Math.floor(Math.random() * questions.length)];
      document.getElementById("question").textContent = q;
    };

    // --- Daily Reflection ---
    const reflectionInput = document.getElementById("reflection");
    const reflectionList = document.getElementById("reflectionList");

    document.getElementById("saveReflection").onclick = async () => {
      const text = reflectionInput.value.trim();
      if (!text) return;
      addReflectionToPage(text);
      reflectionInput.value = "";

      await addDoc(collection(db, "reflections"), {
        text,
        date: new Date()
      });
    };

    function addReflectionToPage(text) {
      const li = document.createElement("li");
      li.textContent = text;
      reflectionList.appendChild(li);
    }

    // --- Load previous data ---
    async function loadData() {
      const logsSnapshot = await getDocs(collection(db, "logs"));
      logsSnapshot.forEach(doc => addLogToPage(doc.data().entry));

      const reflectionsSnapshot = await getDocs(collection(db, "reflections"));
      reflectionsSnapshot.forEach(doc => addReflectionToPage(doc.data().text));
    }

    loadData();
  </script>
</body>
</html>
